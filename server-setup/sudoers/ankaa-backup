# Sudoers configuration for Ankaa Backup Operations
# Install: sudo cp this-file /etc/sudoers.d/ankaa-backup && sudo chmod 440 /etc/sudoers.d/ankaa-backup
#
# This allows the kennedy user to manage backup files without password prompts,
# which is necessary when the API service needs to handle files with different ownership.

# Allow kennedy to change ownership of backup files
kennedy ALL=(root) NOPASSWD: /usr/bin/chown -R kennedy\:www-data /srv/files/Backup/*
kennedy ALL=(root) NOPASSWD: /usr/bin/chown kennedy\:www-data /srv/files/Backup/*

# Allow kennedy to set permissions on backup files
kennedy ALL=(root) NOPASSWD: /usr/bin/chmod -R 2775 /srv/files/Backup/*
kennedy ALL=(root) NOPASSWD: /usr/bin/chmod 2775 /srv/files/Backup/*

# Allow kennedy to remove backup files (for cleanup of broken backups)
kennedy ALL=(root) NOPASSWD: /usr/bin/rm -rf /srv/files/Backup/*
kennedy ALL=(root) NOPASSWD: /usr/bin/rm -f /srv/files/Backup/*

# Allow kennedy to create directories in backup path
kennedy ALL=(root) NOPASSWD: /usr/bin/mkdir -p /srv/files/Backup/*
