# Samba Configuration for Ankaa Files Server
# SECURE CONFIGURATION - Password Required
#
# Access Control:
# - ankaa-admins (kennedy, genivaldo, sergio): Full access to all shares
# - ankaa-artes (leandro): Access only to Artes and Auxiliares

[global]
    # Server identification
    workgroup = ANKAA
    server string = Ankaa Arquivos Server
    netbios name = ANKAA-FILES

    # Security settings - NO GUEST ACCESS
    security = user
    map to guest = Never
    guest account = nobody
    restrict anonymous = 2

    # Hide server from public browsing (only authenticated users see shares)
    browseable = no

    # Logging
    log file = /var/log/samba/log.%m
    max log size = 1000
    logging = file

    # Performance tuning
    socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=65536 SO_SNDBUF=65536
    read raw = yes
    write raw = yes
    use sendfile = yes
    aio read size = 16384
    aio write size = 16384

    # Character encoding (UTF-8 for Portuguese)
    unix charset = UTF-8
    dos charset = CP850

    # Network settings - Only local network
    interfaces = lo enp42s0
    bind interfaces only = yes
    hosts allow = 192.168.10. 127.0.0.1
    hosts deny = 0.0.0.0/0

    # Disable printer sharing
    load printers = no
    printing = bsd
    printcap name = /dev/null
    disable spoolss = yes

    # macOS compatibility
    fruit:nfs_aces = no
    fruit:aapl = yes
    vfs objects = fruit streams_xattr

    # Windows compatibility
    ntlm auth = ntlmv2-only
    min protocol = SMB2
    max protocol = SMB3

# ===================================
# ADMIN SHARES - Full Access
# kennedy, genivaldo, sergio only
# ===================================

[Arquivos]
    comment = Ankaa Files Storage (Arquivos)
    path = /srv/files
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Projetos]
    comment = Projetos e Artes (Task Artworks)
    path = /srv/files/Projetos
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Orcamentos]
    comment = Orcamentos (Budgets)
    path = /srv/files/Orcamentos
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[NotasFiscais]
    comment = Notas Fiscais (Invoices)
    path = /srv/files/Notas Fiscais
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Comprovantes]
    comment = Comprovantes (Receipts)
    path = /srv/files/Comprovantes
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Logos]
    comment = Logos de Clientes e Fornecedores
    path = /srv/files/Logos
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Colaboradores]
    comment = Arquivos de Colaboradores
    path = /srv/files/Colaboradores
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Aerografias]
    comment = Projetos de Aerografia
    path = /srv/files/Aerografias
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Plotter]
    comment = Arquivos de Plotter (Corte)
    path = /srv/files/Plotter
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

[Backup]
    comment = Backup Files
    path = /srv/files/Backup
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins
    write list = @ankaa-admins
    guest ok = no

# ===================================
# ARTIST SHARES - Leandro Access
# Also accessible by admins
# ===================================

[Artes]
    comment = Artes (Design Files - Leandro)
    path = /srv/files/Artes
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins @ankaa-artes
    write list = @ankaa-admins @ankaa-artes
    guest ok = no

[Auxiliares]
    comment = Arquivos Auxiliares (Leandro)
    path = /srv/files/Auxiliares
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa-admins @ankaa-artes
    write list = @ankaa-admins @ankaa-artes
    guest ok = no
