# Samba Configuration for Ankaa Files Server
# User-facing name: "Arquivos" (Files in Portuguese)
# Internal name: "files"
#
# This configuration provides file sharing for the Ankaa application
# Files are accessible via SMB/CIFS protocol on the local network
# and served via HTTPS at arquivos.ankaa.live

[global]
    # Server identification
    workgroup = ANKAA
    server string = Ankaa Arquivos Server
    netbios name = ANKAA-FILES

    # Security settings
    security = user
    map to guest = Bad User
    guest account = nobody

    # Logging
    log file = /var/log/samba/log.%m
    max log size = 1000
    logging = file

    # Performance tuning
    socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=65536 SO_SNDBUF=65536
    read raw = yes
    write raw = yes
    use sendfile = yes
    aio read size = 16384
    aio write size = 16384

    # Character encoding (UTF-8 for Portuguese)
    unix charset = UTF-8
    dos charset = CP850

    # Network settings
    interfaces = lo eth0
    bind interfaces only = yes

    # Disable printer sharing
    load printers = no
    printing = bsd
    printcap name = /dev/null
    disable spoolss = yes

    # macOS compatibility
    fruit:nfs_aces = no
    fruit:aapl = yes
    vfs objects = fruit streams_xattr

    # Windows compatibility
    ntlm auth = ntlmv2-only
    min protocol = SMB2
    max protocol = SMB3

# ===================================
# MAIN FILES SHARE - "Arquivos"
# ===================================
[Arquivos]
    comment = Ankaa Files Storage (Arquivos)
    path = /srv/files
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

    # Enable file versioning (shadow copies)
    vfs objects = shadow_copy2
    shadow:snapdir = .snapshots
    shadow:basedir = /srv/files
    shadow:sort = desc
    shadow:format = @GMT-%Y.%m.%d-%H.%M.%S

    # macOS specific
    fruit:time machine = no

# ===================================
# PROJETOS - Task Artworks
# ===================================
[Projetos]
    comment = Projetos e Artes (Task Artworks)
    path = /srv/files/Projetos
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# ORCAMENTOS - Budgets
# ===================================
[Orcamentos]
    comment = Orcamentos (Budgets)
    path = /srv/files/Orcamentos
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# NOTAS FISCAIS - Invoices
# ===================================
[NotasFiscais]
    comment = Notas Fiscais (Invoices)
    path = /srv/files/Notas Fiscais
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# COMPROVANTES - Receipts
# ===================================
[Comprovantes]
    comment = Comprovantes (Receipts)
    path = /srv/files/Comprovantes
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# LOGOS - Company Logos
# ===================================
[Logos]
    comment = Logos de Clientes e Fornecedores
    path = /srv/files/Logos
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# COLABORADORES - Employee Files
# ===================================
[Colaboradores]
    comment = Arquivos de Colaboradores
    path = /srv/files/Colaboradores
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# AEROGRAFIAS - Airbrushing
# ===================================
[Aerografias]
    comment = Projetos de Aerografia
    path = /srv/files/Aerografias
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# PLOTTER - Cut Files
# ===================================
[Plotter]
    comment = Arquivos de Plotter (Corte)
    path = /srv/files/Plotter
    browseable = yes
    read only = no
    create mask = 0664
    directory mask = 2775
    force group = ankaa
    valid users = @ankaa
    write list = @ankaa
    guest ok = no

# ===================================
# READ-ONLY SHARE FOR GUESTS
# ===================================
[Publico]
    comment = Arquivos Publicos (Read-Only)
    path = /srv/files/Publico
    browseable = yes
    read only = yes
    guest ok = yes
